# Maintainer:  Juergen Daubert, jue at crux dot nu
# Description: Ruby interpreter
# URL:         http://www.ruby-lang.org
# Depends on:  gdbm ncurses openssl readline zlib libffi libyaml

name=ruby
version=2.1.2
release=1
source=(ftp://ftp.ruby-lang.org/pub/$name/2.1/$name-$version.tar.bz2
	$name-$version-ffi_version.patch)

build () {
    cd $name-$version

    patch -Np1 < $SRC/$name-$version-ffi_version.patch
    sed -i ext/readline/readline.c \
	-e "s:(Function \*)readline:(rl_hook_func_t \*)readline:"

    ./configure --prefix=/usr \
                --mandir=/usr/man \
                --enable-shared \
                --disable-install-doc \
                --with-ruby-version=minor 

    make
    make DESTDIR=$PKG install
}
